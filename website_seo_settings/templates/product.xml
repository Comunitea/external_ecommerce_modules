<?xml version="1.0" encoding="UTF-8" ?>
<odoo>

    <!-- The product template changes -->
    <template id="website_sale_product" name="Product Seo" inherit_id="website_sale.product">

        <!-- Product descriptions -->
        <xpath expr="//div[@id='product_details']//div[hasclass('o_not_editable')]" position="after">
            <div class="o_not_editable">
                <hr t-if="product.description_short" />
                <p t-field="product.description_short"/>
            </div>
        </xpath>
        <xpath expr="//div[@id='product_full_description']" position="replace">
            <div class="oe_structure mt16 mb16" id="product_full_description" t-if="product.description_full">
                <div class="container" t-if="len(product.description_full) > 15" itemprop="description">
                    <div class="oe_structure mt16" t-field="product.description_full"/>
                </div>
            </div>
        </xpath>

        <!-- ECommerce category link in breadcrumbs without breadcrumbs_base_tmp module installed -->
<!--        <xpath expr="//ol[hasclass('breadcrumb')]/li[@t-if='category']" position="replace">-->
<!--            <li t-if="product.public_categ_ids">-->
<!--                <t t-set="inc" t-value="0"/>-->
<!--                <t t-foreach="product.public_categ_ids" t-as="cat">-->
<!--                    <t t-if="inc==0">-->
<!--                        <a t-att-href="'/category/%s' % cat.slug if cat.slug else '/shop/category/%s' % slug(cat)" t-field="cat.name" />-->
<!--                    </t>-->
<!--                    <t t-set="inc" t-value="inc+1"/>-->
<!--                </t>-->
<!--            </li>-->
<!--        </xpath>-->

        <!-- Hide guarantee -->
        <xpath expr="//div[@id='product_details']/p[last()]" position="attributes">
            <attribute name="t-if">True == False</attribute>
        </xpath>
    </template>

    <!-- Product item used by /shop and /shop/cart -->
    <template id="website_sale_products_item" name="Product Item Seo" inherit_id="website_sale.products_item">
        <!-- Image URL and attributes -->
        <xpath expr="//div[hasclass('oe_product_image')]/a/span" position="replace">
            <span><img t-att-alt="product.name" t-att-title="product.name" t-attf-src="/web/image/product.template/{{product.id}}/image_medium"/></span>
        </xpath>
        <!-- Friendly URL for product (from image) -->
        <xpath expr="//div[hasclass('oe_product_image')]/a" position="attributes">
            <attribute name="t-att-href">'/product/{}'.format(product.slug) if product.slug else keep('/shop/product/%s' % slug(product))</attribute>
        </xpath>
        <!-- Friendly URL for product (from name) -->
        <xpath expr="//a[@itemprop='name']" position="attributes">
            <attribute name="t-att-href">'/product/{}'.format(product.slug) if product.slug else keep('/shop/product/%s' % slug(product))</attribute>
        </xpath>
    </template>

    <!-- Product item add to cart button used by /shop -->
    <template id="website_sale_products_add_to_cart" name="Add to Cart Seo" inherit_id="website_sale.products_add_to_cart">
        <xpath expr="//t[2]/a" position="attributes">
            <attribute name="t-att-href">keep('/product/{}', page=(pager['page']['num'] if pager['page']['num']&gt;1 else None)).format(product.slug) if product.slug else keep('/shop/product/%s' % slug(product), page=(pager['page']['num'] if pager['page']['num']&gt;1 else None))</attribute>
        </xpath>
    </template>

     <template id="website_sale_shop_product_carousel" name="Shop Product Carousel Seo" inherit_id="website_sale.shop_product_carousel">
         <!-- Image URL and attributes -->
         <xpath expr="//div[hasclass('carousel-inner')]" position="replace">
             <div class="carousel-inner">
                 <div t-if="variant_img" class="carousel-item active">
                     <img t-att-alt="product.name" t-att-title="product.name" class="product_detail_img js_variant_img"
                          t-attf-src="/website/image/product.template/{{product.id}}/image/" itemprop="image"/>
                 </div>
                 <div t-attf-class="carousel-item#{'' if variant_img else ' active'}">
                     <img t-att-alt="product.name" t-att-title="product.name" class="product_detail_img"
                          t-attf-src="/website/image/product.template/{{product.id}}/image/" itemprop="image"/>
                 </div>
                 <t t-if="len(image_ids)" t-foreach="image_ids" t-as="pimg">
                     <div class="carousel-item">
                         <img t-att-alt="pimg.name" t-att-title="pimg.name" class="product_detail_img"
                              t-attf-src="/web/image/product.image/{{pimg.id}}/image/" itemprop="image"/>
                     </div>
                 </t>
             </div>
         </xpath>
        <xpath expr="//ol[hasclass('carousel-indicators')]" position="replace">
            <ol t-if="len(image_ids) or variant_img" class="carousel-indicators">
                <li t-if="variant_img" data-target="#o-carousel-product" data-slide-to="0" class="active">
                    <img class="img img-fluid js_variant_img_small" t-attf-src="/website/image/product.product/{{product_variant.id}}/image/90x90" t-att-alt="product.name" t-att-title="product.name"/>
                </li>
                <li data-target="#o-carousel-product" t-att-data-slide-to="1 if variant_img else '0'" t-att-class="'' if variant_img else 'active'">
                    <img class="img img-fluid" t-attf-src="/website/image/product.template/{{product.id}}/image/90x90" t-att-alt="product.name" t-att-title="product.name"/>
                </li>
                <t t-if="len(image_ids)" t-foreach="image_ids" t-as="pimg">
                    <li data-target="#o-carousel-product" t-att-data-slide-to="pimg_index + (variant_img and 2 or 1)">
                        <img class="img img-fluid" t-attf-src="/website/image/product.image/{{pimg.id}}/image/90x90" t-att-alt="pimg.name" t-att-title="pimg.name"/>
                    </li>
                </t>
            </ol>
        </xpath>
     </template>

     <template id="website_tag_template" name="Website tag template">
        <a rel="noindex" t-att-href="'/tag/%s' % tag.slug"  t-att-class="'btn btn-secondary mb8 tag-%s' % tag.color">
            <span t-field="tag.name"/>
        </a>
    </template>

    <template id="website_sale_search_for_tags" name="Search Box Tags">
        <form t-att-action="keep('/tag/' + current_tag.slug, search=0)" method="get" t-att-class="_classes">
            <t t-if="attrib_values">
                <t t-foreach="attrib_values" t-as="a">
                    <input type="hidden" name="attrib" t-att-value="'%s-%s' % (a[0], a[1])" />
                </t>
            </t>
            <t t-call="website.website_search_box" />
        </form>
    </template>

     <template id="product_tags" inherit_id="website_sale.product" name="Product Tags" active="True" customize_show="True">
        <xpath expr="//div[@id='product_details']" position="inside">
            <t t-if="product.tag_ids">
                <div class="oe_structure mt16">
                    <t t-foreach="product.tag_ids" t-as="tag">
                        <t t-call="website_seo_settings.website_tag_template">
                            <t t-set="tag" t-value="tag"/>
                        </t>
                    </t>
                </div>
            </t>
        </xpath>
    </template>

    <template id="website_sale_products" inherit_id="website_sale.products" name="Products Tags" active="True" customize_show="True">
        <!-- Add Product Tags side menu -->
        <xpath expr="//div[@id='products_grid_before']" position="inside">
            <t t-set="tags" t-value="request.env['product.template.tag'].search([], limit=50)"/>
            <t t-if="tags">
                <h5 class="text-uppercase grid-before-tag"><strong>Product Tags</strong></h5>
                <div class="nav nav-pills flex-column menu-category pt8">
                    <div class="oe_structure">
                        <t t-foreach="tags" t-as="tag">
                            <t t-call="website_seo_settings.website_tag_template">
                                <t t-set="tag" t-value="tag"/>
                            </t>
                        </t>
                    </div>
                </div>
            </t>
        </xpath>
        <!-- Default search -->
        <xpath expr="//t[@t-call='website_sale.search']" position="attributes">
            <attribute name="t-if">not list_type</attribute>
        </xpath>
        <!-- Search products into tags context -->
        <xpath expr="//t[@t-call='website_sale.search']" position="after">
            <t t-if="list_type and list_type == 'tags'">
                <t t-call="website_seo_settings.website_sale_search_for_tags">
                    <t t-set="_classes">o_website_sale_search</t>
                </t>
            </t>
        </xpath>
    </template>

    <template id="website_sale_products_categories" inherit_id="website_sale.products_categories" name="eCommerce Categories Seo">
        <!-- Add Categories Title -->
        <xpath expr="//div[@id='products_grid_before']//ul" position="before">
            <h5 class="text-uppercase grid-before-categ"><strong>Categories</strong></h5>
        </xpath>
    </template>

</odoo>